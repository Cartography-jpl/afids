procedure
parm lon type=real
parm lat type=real

local zone type=real
local izone type=int
local szone type=string
local snorth type=string
local utmstr type=string

refgbl $echo
body
let $echo="no"

let zone = (lon+186.0)/6.0
let izone = $fix(zone)
let szone = "&izone"
if (izone<10) let szone = "0" // "&szone"
let snorth = "6"
if (lat<0.0) let snorth = "7"

let utmstr = "32" // "&snorth" // "&szone"
let utmstr = utmstr // "(PCS_WGS84_UTM_zone_" // "&szone"
if (lat<0.0) let utmstr = utmstr // "S)"
if (lat>=0.0) let utmstr = utmstr // "N)"

ibis-gen xxpqrs1 nr=1 nc=6 datacols=(1,2) data=(&lon,&lat) +
      format=("DOUB","DOUB","DOUB","DOUB")


gtgen out=xxxpqrslab1 +
   geotiff=("GTModelTypeGeoKey=2(ModelTypeGeographic)", +
          "GeogEllipsoidGeoKey=7030(Ellipse_WGS84)")
gtgen out=xxxpqrslab2 +
  geotiff=("ProjectedCSTypeGeoKey=&utmstr")

gtlist xxxpqrslab2


gtproj (xxpqrs1,xxxpqrslab1,xxxpqrslab2) incol=(1,2,5) +
      outcol=(3,4,6) 'tec


ibis-list xxpqrs1 cols=(1,2,3,4) 'nohead 'nocol

theend>
end-proc

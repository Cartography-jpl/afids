procedure
refgbl $echo
refgbl $autousage
body
let $echo="no"
let $autousage="none"
let _onfail="continue"


! Test error cases: col 1 not sorted file 1

Write "  Test error cases: col 1 not sorted file 1"
   ibis-gen a nc=2 nr=5 index=2 datacol=1 +
     data=(2,1,2,3,4)
   ibis-gen b nc=2 nr=5 index=2 datacol=1 +
     data=(1,3,4,4,5)

   
   mf3 a f="c2=c2+50"
   mf3 b f="c2=c2+80"
   
   ibis-list a
   ibis-list b

   zipcol2 inp=(a,b) incol=(1) outcol=(2) +
          file=(1,2) null=(789)


! Test error cases: col 1 not sorted file 2

Write " Test error cases: col 1 not sorted file 2"
   ibis-gen a nc=2 nr=5 index=2 datacol=1 +
     data=(1,1,2,3,4)
   ibis-gen b nc=2 nr=5 index=2 datacol=1 +
     data=(1,3,4,3,5)

   
   mf3 a f="c2=c2+50"
   mf3 b f="c2=c2+80"
   
   ibis-list a
   ibis-list b

   zipcol2 inp=(a,b) incol=(1) outcol=(2) +
          file=(1,2) null=(789)


! Test error cases: col 2 not sorted file 1

Write " Test error cases: col 2 not sorted file 1"
   ibis-gen a nc=3 nr=5 index=3 datacol=1 +
     data=(1,1,2,3,4)
   ibis-gen b nc=3 nr=5 index=3 datacol=1 +
     data=(1,3,4,4,5)

   
   mf3 a f="c2=1+(@index<1.5)$c3=c3+50"
   mf3 b f="c2=1+(@index<1.5)$c3=c3+80"
   
   ibis-list a
   ibis-list b

   zipcol2 inp=(a,b) incol=(1,2) outcol=(3) +
          file=(1,2,3) null=(789)


! Test error cases: col 2 not sorted file 2

Write " Test error cases: col 2 not sorted file 2"
   ibis-gen a nc=3 nr=5 index=3 datacol=1 +
     data=(1,1,2,3,4)
   ibis-gen b nc=3 nr=5 index=3 datacol=1 +
     data=(1,3,4,4,5)

   
   mf3 a f="c2=1$c3=c3+50"
   mf3 b f="c2=1+(@index>2.5)*(@index<3.5)$c3=c3+80"
   
   ibis-list a
   ibis-list b

   zipcol2 inp=(a,b) incol=(1,2) outcol=(3) +
          file=(1,2,3) null=(789)

   ibis-list a

! repeat the above four cases with alpha indexes


! Test error cases: col 2 not sorted file 1, alpha data

Write "  Test error cases: col 2 not sorted file 1, alpha data"

   ibis-gen a nc=4 nr=5 index=2 datacol=1 +
     data=(1,1,2,3,4) 'ibis-2 format=(FULL,FULL,A12,A12) +
     strcol=(3,4) +
     string=(aaaaaa2,bbbbbb1,aaaaaa1,bbbbbb2,aaaaaa3, +
      bbbbbb3,aaaaaa4,bbbbbb4,aaaaaa5,bbbbbb5)
   ibis-gen b nc=4 nr=5 index=2 datacol=1 +
     data=(1,3,4,4,5) 'ibis-2 format=(FULL,FULL,A12,A12) +
     strcol=(3,4) +
     string=(aaaaaa1,yyyyyy1,aaaaaa4,yyyyyy2,aaaaaa5, +
       yyyyyy3,aaaaaa5,yyyyyy4,aaaaaa6,yyyyyy5)
   

   mf3 a f="c2=c2+50"
   mf3 b f="c2=c2+80"
   
   ibis-list a
   ibis-list b

   zipcol2 inp=(a,b) incol=(1,3) outcol=(2,4) +
          file=(1,3,2,4) null=(789) nulstr=("nulla")

   ibis-list a


! Test error cases: col 2 not sorted file 2, alpha data

Write "  Test error cases: col 2 not sorted file 2, alpha data"

   ibis-gen a nc=4 nr=5 index=2 datacol=1 +
     data=(1,1,2,3,4) 'ibis-2 format=(FULL,FULL,A12,A12) +
     strcol=(3,4) +
     string=(aaaaaa1,bbbbbb1,aaaaaa2,bbbbbb2,aaaaaa3, +
      bbbbbb3,aaaaaa4,bbbbbb4,aaaaaa5,bbbbbb5)
   ibis-gen b nc=4 nr=5 index=2 datacol=1 +
     data=(1,3,4,4,5) 'ibis-2 format=(FULL,FULL,A12,A12) +
     strcol=(3,4) +
     string=(aaaaaa1,yyyyyy1,aaaaaa4,yyyyyy2,aaaaaa5, +
       yyyyyy3,aaaaaa4,yyyyyy4,aaaaaa6,yyyyyy5)
   
   mf3 a f="c2=c2+50"
   mf3 b f="c2=c2+80"
   
   ibis-list a
   ibis-list b

   zipcol2 inp=(a,b) incol=(1,3) outcol=(2,4) +
          file=(1,3,2,4) null=(789) nulstr=("nulla")

   ibis-list a

! Test error cases: col 1 not sorted file 1, alpha data

Write "  Test error cases: col 1 not sorted file 1, alpha data"

   ibis-gen a nc=4 nr=5 index=2 datacol=1 +
     data=(1,1,2,3,4) 'ibis-2 format=(FULL,FULL,A12,A12) +
     strcol=(3,4) +
     string=(aaaaaa2,bbbbbb1,aaaaaa1,bbbbbb2,aaaaaa3, +
      bbbbbb3,aaaaaa4,bbbbbb4,aaaaaa5,bbbbbb5)
   ibis-gen b nc=4 nr=5 index=2 datacol=1 +
     data=(1,3,4,4,5) 'ibis-2 format=(FULL,FULL,A12,A12) +
     strcol=(3,4) +
     string=(aaaaaa1,yyyyyy1,aaaaaa4,yyyyyy2,aaaaaa5, +
       yyyyyy3,aaaaaa5,yyyyyy4,aaaaaa6,yyyyyy5)
  
   mf3 a f="c2=c2+50"
   mf3 b f="c2=c2+80"
   
   ibis-list a
   ibis-list b

   zipcol2 inp=(a,b) incol=(3,1) outcol=(2,4) +
          file=(3,1,2,4) null=(789) nulstr=("nulla")

   ibis-list a

! Test error cases: col 1 not sorted file 2, alpha data

Write "  Test error cases: col 1 not sorted file 2, alpha data"

   ibis-gen a nc=4 nr=5 index=2 datacol=1 +
     data=(1,1,2,3,4) 'ibis-2 format=(FULL,FULL,A12,A12) +
     strcol=(3,4) +
     string=(aaaaaa1,bbbbbb1,aaaaaa2,bbbbbb2,aaaaaa3, +
      bbbbbb3,aaaaaa4,bbbbbb4,aaaaaa5,bbbbbb5)
   ibis-gen b nc=4 nr=5 index=2 datacol=1 +
     data=(1,3,4,4,5) 'ibis-2 format=(FULL,FULL,A12,A12) +
     strcol=(3,4) +
     string=(aaaaaa1,yyyyyy1,aaaaaa4,yyyyyy2,aaaaaa5, +
       yyyyyy3,aaaaaa4,yyyyyy4,aaaaaa6,yyyyyy5)
  
   mf3 a f="c2=c2+50"
   mf3 b f="c2=c2+80"
   
   ibis-list a
   ibis-list b

   zipcol2 inp=(a,b) incol=(3,1) outcol=(2,4) +
          file=(3,1,2,4) null=(789) nulstr=("nulla")

   ibis-list a

! Test write num to alpha column error

Write "  Test write num to alpha column error"

   ibis-gen a nc=4 nr=5 index=2 datacol=1 +
     data=(1,1,2,3,4) 'ibis-2 format=(FULL,FULL,A12,A12) +
     strcol=(3,4) +
     string=(aaaaaa1,bbbbbb1,aaaaaa2,bbbbbb2,aaaaaa3, +
      bbbbbb3,aaaaaa4,bbbbbb4,aaaaaa5,bbbbbb5)
   ibis-gen b nc=4 nr=5 index=2 datacol=1 +
     data=(1,3,4,4,5) 'ibis-2 format=(FULL,FULL,A12,A12) +
     strcol=(3,4) +
     string=(aaaaaa1,yyyyyy1,aaaaaa4,yyyyyy2,aaaaaa5, +
       yyyyyy3,aaaaaa5,yyyyyy4,aaaaaa6,yyyyyy5)
   
   mf3 a f="c2=c2+50"
   mf3 b f="c2=c2+80"
   
   ibis-list a
   ibis-list b

   zipcol2 inp=(a,b) incol=(1,3) outcol=(4) +
          file=(1,3,2) null=(789) nulstr=("nulla")

   ibis-list a


! Test write alpha to num column error

Write "  Test write alpha to num column error"

   ibis-gen a nc=4 nr=5 index=2 datacol=1 +
     data=(1,1,2,3,4) 'ibis-2 format=(FULL,FULL,A12,A12) +
     strcol=(3,4) +
     string=(aaaaaa1,bbbbbb1,aaaaaa2,bbbbbb2,aaaaaa3, +
      bbbbbb3,aaaaaa4,bbbbbb4,aaaaaa5,bbbbbb5)
   ibis-gen b nc=4 nr=5 index=2 datacol=1 +
     data=(1,3,4,4,5) 'ibis-2 format=(FULL,FULL,A12,A12) +
     strcol=(3,4) +
     string=(aaaaaa1,yyyyyy1,aaaaaa4,yyyyyy2,aaaaaa5, +
       yyyyyy3,aaaaaa5,yyyyyy4,aaaaaa6,yyyyyy5)
   
   mf3 a f="c2=c2+50"
   mf3 b f="c2=c2+80"
   
   ibis-list a
   ibis-list b

   zipcol2 inp=(a,b) incol=(1,3) outcol=(2) +
          file=(1,3,4) null=(789) nulstr=("nulla")

   ibis-list a


! Test index alpha to num column error

Write "  Test index alpha to num column error"

   ibis-gen a nc=4 nr=5 index=2 datacol=1 +
     data=(1,1,2,3,4) 'ibis-2 format=(FULL,FULL,A12,A12) +
     strcol=(3,4) +
     string=(aaaaaa1,bbbbbb1,aaaaaa2,bbbbbb2,aaaaaa3, +
      bbbbbb3,aaaaaa4,bbbbbb4,aaaaaa5,bbbbbb5)
   ibis-gen b nc=4 nr=5 index=2 datacol=1 +
     data=(1,3,4,4,5) 'ibis-2 format=(FULL,FULL,A12,A12) +
     strcol=(3,4) +
     string=(aaaaaa1,yyyyyy1,aaaaaa4,yyyyyy2,aaaaaa5, +
       yyyyyy3,aaaaaa5,yyyyyy4,aaaaaa6,yyyyyy5)
   
   mf3 a f="c2=c2+50"
   mf3 b f="c2=c2+80"
   
   ibis-list a
   ibis-list b

   zipcol2 inp=(a,b) incol=(1,3) outcol=(4) +
          file=(3,1,4) null=(789) nulstr=("nulla")

   ibis-list a

theend>
end-proc

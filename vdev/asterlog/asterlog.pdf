process help=*
parm inp       type=(string,99)
parm out       type=(string,99) default=""

parm sensor    type=(string,99) default=""
parm lookback  type=int         default=0

parm sl        type=int  default=-999
parm ss        type=int  default=-999
parm nl        type=int  default=-999
parm ns        type=int  default=-999

parm doimg     type=int         default=1
parm echoMeta  type=int         default=0

parm pseudo  type=keyword count=(0:1) valid=pseudo default=--

end-proc
.title
VICAR Program asterlog - logs ASTER data sets to VICAR/IBIS
.help
PURPOSE

     ASTERLOG logs an optionally user-specified sub-area of an
     ASTER archive file to VICAR/IBIS.

.PAGE
TAE COMMAND LINE FORMAT

     asterlog INP OUT SENSOR LOOKBACK SL SS NL NS DOIMG ECHOMETA
     
     where

     INP is a single parameter specifying the input ASTER data set.

     OUT is the optional output file name prefix. If no output prefix
         is provided, one is autogenerated with the form:
         TERRA_ASTER_YYYYMMDD_HHMM_PRODUCT, where PRODUCT is
             SE-05     for Surface Emissivity
             SKT-08    for Surface Kinetic Temperature
             SRTIR-09T for Surface Radiance TIR
             omitted   for 1A and 1B products
         The prefix is appended with _band for multiband products.

     SENSOR is one of (VNIR, SWIR, TIR)

       VNIR generates 4 images (3 for Expedited sets)
       SWIR generates 6 images
       TIR generates 5 images
       The SENSOR parameter is appropriate only for 1A and 1B products.

     LOOKBACK is a flag indicating extraction of VNIR band 3B only.
       The LOOKBACK flag is appropriate only for 1A and 1B products.

     sl start line (one based value with (1,1) pixel in nw corner
     ss start sample (one based value)
     nl number of lines to extract
     ns number of samples to extract
     doimg is a flag causing images to be generated
     echometa is a flag causing the metadata to be displayed
     pseudo is a flag causing AST_05 and AST_08 to be treated like TIR

.PAGE
OPERATION

     ASTERLOG logs a user-specified sub-area of an ASTER data set
     archive file to VICAR/IBIS. ASTERLOG recognizes the following
     ASTER archive products:
       Level 1A (up to 16 bands)
       Level 1B (up to 16 bands)
       Surface Emissivity "AST_05" (5 bands)
       Surface Kinetic Temperature "AST_08" (1 band)
       Surface Radiance TIR "AST_09T" (5 bands)

     The extracted images vary in resolution, wavelength and image 
     depth, according to sensor and band as follows:

     VNIR - Visible Near Infrared (15 Meters resolution)
     Band 1 (0.52 - 0.60)  8-bit
     Band 2 (0.63 - 0.69)  8-bit
     Band 3N (0.78 - 0.86) 8-bit
     Band 3B (0.78 - 0.86) 8-bit (not avilable in Expedited sets)

     SWIR - Shortwave Near Infrared (30 Meters resolution)
     Band 4 (1.600 - 1.700) 8-bit
     Band 5 (2.145 - 2.185) 8-bit
     Band 6 (2.185 - 2.225) 8-bit
     Band 7 (2.235 - 2.285) 8-bit
     Band 8 (2.295 - 2.365) 8-bit
     Band 9 (2.360 - 2.430) 8-bit

     TIR - Thermal Infrared (90 Meters resolution)
     Band 10 (8.125 - 8.475)  16-bit
     Band 11 (8.475 - 8.825)) 16-bit
     Band 12 (8.925 - 9.275)  16-bit
     Band 13 (10.25 - 10.95)  16-bit
     Band 14 (10.95 - 11.65)  16-bit

     The IBIS files contain an 11x11 table of (line, sample, lat, lon)
     double precision float quadruples, used to navigate the extracted
     image. The line=1, sample=1 value holds the location of the
     center of the upper left image pixel. The line=11, sample=11
     value holds the location of the center of the pixel just below
     and to the right of the bottom right image pixel, i.e. the
     location of a pixel just outside of the image. The other values
     hold the locations of other image pixels determined by
     interpolation. For example, if the image has a shape of 100 lines
     by 200 samples, the line=2, sample=2 value in the navigation
     table will hold the location of the center of the image pixel at
     line = 11, sample = 21. In general, for either dimension, the nth
     nav value maps to a pixel position given by ((n-1)*size/10)+1.
     The navigation information is exported to VICAR GeoTIFF labels.
   
     The meta data file contains several values about the source
     archive file, ASTER specific data, the logging event, and the
     output files. Level 1B products include sensor pointing angle, and
     solar azimuth and elevation in the meta data.

.PAGE
     
RESTRICTIONS

     The input ASTER archive must be in HDF-EOS format as documented
     in "ASTER LEVEL 1 DATA PRODUCTS SPECIFICATION (GDS Version)
     Version 1.3" (AG-E-E-2209-R03).

.PAGE
COGNIZANT PROGRAMMER:  W. L. Bunch
WRITTEN BY:            W. L. Bunch

REVISIONS: 
  Tue Dec 16 2008
    pkim added to retrieve gain information and fixed calendar date

  Sat Dec 29 2007 wlb switched to USES_ANSI_C AND LIB_CARTO; misc cleanup

  Tue Mar 20 2007
    Added pseudo parm.

  Fri Mar 25 2005
    Ported to linux.

  Thu Sep  4 2003
    Fixed a buffer bug.

  Thu Jun  5 2003
    Added support for Surface Emissivity and Surface Radiance products.

  Mon Sep 16 2002
    Added "level" parameter, used to select one of "1A", "1B",
    Kinetic.

  Fri Jan 11 2002
    Initial version

.level1
.var inp
ASTER data set file name
.var out
Output file prefix
.var sensor
The sensor name (one of VNIR, SWIR, TIR)
.var lookback
Flag indicating (when non zero) extraction of VNIR band 3B only.
.var sl
Starting line of sub-area.
.var ss
Starting sample of sub-area.
.var nl
Number of lines of sub-area.
.var ns
Number of samples of sub-area.
.level2
.var sl
Starting line of sub-area within ASTER archive data set. This is a
one-based value.
.var ss
Starting sample of sub-area within ASTER archive data set. This is a
one-based value.
.var nl
Number of lines to extract from the ASTER archive data set.
.var ns
Number of samples to extract from ASTER archive data set.
.end

process help=*
PARM INP   TYPE=STRING
PARM OUT   TYPE=STRING
PARM SIZE  TYPE=INTEGER COUNT=4                DEFAULT=(1,1,0,0)
PARM SL    TYPE=INTEGER                        DEFAULT=1
PARM SS    TYPE=INTEGER                        DEFAULT=1
PARM NL    TYPE=INTEGER                        DEFAULT=0
PARM NS    TYPE=INTEGER                        DEFAULT=0
PARM LINE  TYPE=INTEGER COUNT=1:100            DEFAULT=0
PARM DN    TYPE=INTEGER                        DEFAULT=0
PARM NOAVG TYPE=KEYWORD VALID=NOAVG COUNT=0:1  DEFAULT=--
PARM TRUNC TYPE=KEYWORD VALID=TRUNC COUNT=0:1  DEFAULT=--
PARM NOFIX TYPE=KEYWORD VALID=NOFIX COUNT=0:1  DEFAULT=--
PARM NOPRINT TYPE=KEYWORD VALID=NOPRINT COUNT=0:1 DEFAULT=--
END-PROC

.TITLE
 INSERT - insert lines into an image.
.HELP

 PURPOSE:
 INSERT is an applications program that will insert
 artificial lines in a picture and rescale the
 remaining lines down the appropriate amount. Insert
 is useful for correcting misregistration due to
 line dropout.

 DESCRIPTION:

 The parameters are generated on the basis that
 the input image has less lines than is desired.
 This could be due to telemetry dropout or other
 corruption process.

 The options of insertion are:
 1) Averaging adjacent lines, the default operation
 2) Inserting a line of specific DN value, 
    (NOAVG or by specifying a NON-ZERO DN)
  
 LINE is an array of line numbers where insertion is
 to occur. They may be successive. A maximum of
 100 lines is permitted. The line numbers are with
 respect to the final output image, not the input.

 TRUNC refers to the final output image. If the 
 resultant image after insertion is bigger than
 desired truncation allows the user to drop the
 excess lines at the bottom of the input image.
 The desired size of the image can be declared
 in the SIZE or NL parameters.

 NOFIX indicates that bad lines will be written as read.
 By default, if a bad line is detected, it is replaced
 by the two options listed above.

 Note: A bad line means a line that generated any
 I/O error STATUS return other than 'END OF FILE' 
 on the internal xvread routine. Basically, this
 is a holdover from when input data was read from
 magnetic tapes.

.PAGE
 EXECUTION:
 The following is the execution statement for INSERT:
        insert  INP  OUT  PARAMS
.PAGE
 EXAMPLES:
 insert INP=A OUT=B SIZE=(1,1,100,200) LINE=(1,10)

 Lines 1 and 10 of the output data set b are artificially
 generated by averaging pixels in adjoining lines.  Lines
 2 through 9 are lines 1 through 8 of the input data set.
 Lines 11 through 102 are lines 9 through 100 of the input
 data set.

 insert INP=A OUT=B SIZE=(1,1,100,200) DN=128 LINE=5 TRUNC=TRUNC

 Line 5 of the output data set, B, will be artificially filled
 with DN value of 128. Lines 1 through 4 are lines 1 through 4
 of the input data set, A. Lines 6 through 100 are lines 5
 through 99 of the input data set, A.
.PAGE
 RESTRICTIONS:

1)  Max. number of lines that can be inserted = 100.

2) If no lines are specified for insertion, the input
 data set is copied to the output dataset.  If an
 unexpected eof occurs, artificial lines are
 added to make up the difference.
 
3) The 2 GB  maximimum image size was removed 1 JUL 2016.
4) Does not support DOUBLE or COMPLEX data sets
5) Input DN is in integer format even if data set
    is REAL data type, cannot enter fraction in DN param.

.PAGE
 ORIGINAL PROGRAMMER:  J. D. ADDINGTON,  19 JUNE 1974
 CONVERTED TO VAX:     J. A. MOSHER,     15 MARCH 1983
 CONVERTED TO VICAR2:  S. POHORSKY,      19 NOV. 1984
 REVISION : 1           L. W. KAMP,      20 JAN. 1985
 Made portable for UNIX Alan Scop (CRI),  2 MAY 1994    

 Revision:              R. J. Bambery,    1 Jul 2016
 Removed 2 GB maximum image size. Updated documentation. 
 Accepts BYTE, HALF, FULL and REAL data sets

     12 Jul 2016 - R. J. Bambery - linked against new stacka_big routine
                Centos-7.2 & gcc-4.8.5
 
 CURRENT COGNIZANT PROGRAMMER:  R. J. BAMBERY
.LEVEL1
.VARIABLE INP
 INPUT DATASET
.VARIABLE OUT
 OUTPUT DATASET
.VARIABLE SIZE
 IMAGE SIZE
.VARI SS
 INTEGER - STARTING SAMPLE
.VARI SL
 INTEGER - STARTING LINE
.VARI NL
 INTEGER - NUMBER OF LINES
.VARI NS
 INTEGER - NUMBER OF SAMPLES
.VARIABLE LINE
 1-100 ARTIFICIAL-LINE NUMBERS
.VARIABLE DN
 DN VALUES OF INSERTED LINE
.VARIABLE NOAVG
 SUPPRESS AVERAGING OF INSERTED PIXELS?
.VARIABLE TRUNC
 OUTPUT LINES TO BE TRUNCATED?
.VARI NOFIX
 SUPPRESS FIXING OF BAD LINES?
.VARI NOPRINT
 SUPPRESS MESSAGES?
.LEVEL2
.VARI INP
 STANDARD VICAR INPUT DATASET PARAMETER
 (ONE DATASET)
.VARI OUT
 STANDARD VICAR1 OUTPUT DATASET PARAMETER
 (ONE DATASET)
.VARI SIZE
 STANDARD VICAR1 SIZE PARAMETER.
.VARIABLE LINE
 NEW LINES WILL BE INSERTED AT THE LINE(S) SPECIFIED.
 LINE NUMBERS ARE WITH RESPECT TO OUTPUT PICTURE.
.VARIABLE DN
 DENOTES THE INSERTED LINE PIXELS HAVE A DN OF VALUE N.
.VARIABLE NOAVG
 VALID KEYWORD VALUE: NOAVG.

 'NOAVG' DENOTES THAT INSERTED LINES WILL HAVE ALL DN'S EQUAL
 TO ZERO (OR TO 'DN', IF THAT PARAMETER IS SPECIFIED).
 DEFAULT IS THAT INSERTED LINE PIXELS ARE GENERATED BY
 AVERAGING THE PIXELS IN NEIGHBORING LINES.

 IF PARAMETER 'DN' IS SPECIFIED, THEN NO AVERAGING WILL BE
 PERFORMED.
.VARIABLE TRUNC
 VALID KEYWORD VALUE: TRUNC.
 THIS DENOTES THE OUTPUT PICTURE WILL BE TRUNCATED TO
 THE NUMBER OF LINES SPECIFIED IN THE SIZE PARAMETER, OR,
 IF NO 'SIZE' SPECIFIED, IN THE INPUT IMAGE.
.VARI NOFIX
 VALID KEYWORD VALUE: NOFIX.

 THIS DENOTES THAT BAD LINES WILL BE WRITTEN AS READ.  DEFAULT IS 
 TO REPLACE A BAD LINE WITH A NEW LINE CONSISTING OF ZEROES OR AN
 AVERAGE OF THE ADJACENT LINES (DEPENDING ON WHETHER 'NOAVG' WAS
 SPECIFIED).

 A BAD LINE MEANS A LINE THAT GENERATED ANY I/O ERROR OTHER THAN
 'END OF FILE' WHEN READ.
.VARI NOPRINT
 VALID KEYWORD VALUE: NOPRINT.

 THIS CAUSES MESSAGES TO BE SUPPRESSED.  IF THIS KEYWORD IS NOT
 SPECIFIED, A MESSAGE WILL BE PRINTED FOR EVERY LINE INSERTED.
.END

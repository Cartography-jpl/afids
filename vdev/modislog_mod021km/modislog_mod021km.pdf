process help=*
parm inp      type=(string,99)
parm geo      type=(string,99) default=""
parm out      type=(string,99) default=""
parm band     type=int default=20
parm high     type=int default=0

parm sl       type=int  default=-999
parm ss       type=int  default=-999
parm nl       type=int  default=-999
parm ns       type=int  default=-999
parm minLat   type=real default=-999.0
parm maxLat   type=real default=-999.0
parm minLon   type=real default=-999.0
parm maxLon   type=real default=-999.0

parm lineSkip     type=int default=1
parm sampSkip     type=int default=10

parm echoMeta  type=int         default=0

end-proc
.title
VICAR Program modislog_mod021km - logs 1km MODIS data sets to VICAR/IBIS
.help
PURPOSE

     MODISLOG_MOD021KM logs an optionally user-specified sub-area of a
     1km MODIS archive file to VICAR/IBIS.

.PAGE
TAE COMMAND LINE FORMAT

     modislog_mod021km INP=A GEO=B OUT=C PARMS
     
     where

     A is the input 1km emissive Modis image file name (usually 
         prefixed MOD021KM).
     B is the optional input Modis geodata file (usually prefixed
         MOD03).
     C is the optional output file name prefix. If no output prefix
         is provided, one is autogenerated with the form:
         PLATFORM_MODIS_1km_YYYYMMDD_HHMM_band, where PLATFORM
         may be TERRA or AQUA.

         Output files have the form prefix_band.img for the generated
         VICAR image file, and prefix.ext where ext is
         txt for the metadata file
         int for the geo data exported as an IBIS file of 
             line/sample/lat/lon/zenith/azimuth if geodata is provided
         The zenith and azimuth are sensor look angles with the zenith
         measured up from nadir.

     PARMS
       sl start line (one based value with (1,1) pixel in nw corner
       ss start sample (one based value)
       nl number of lines to extract
       ns number of samples to extract
       minLat, maxLat, minLon, maxLon used in lieu of sl, ss, nl, ns
       band the band to extract, must be in range 1-36, defaults to 20
       high a flag for bands 13 and 14 selecting the high gain version
       lineSkip, sampSkip used to subsample nav/angle data; skip=1 means 
         include all data

.PAGE
OPERATION

   MODISLOG_MOD021KM logs a user-specified sub-area of a 1km MODIS data set
   archive file to VICAR.


.PAGE
     
RESTRICTIONS


.PAGE
COGNIZANT PROGRAMMER:  W. L. Bunch
WRITTEN BY:            W. L. Bunch

REVISIONS: 
  Fri Dec 28 2007 wlb switched to USES_ANSI_C AND LIB_CARTO; misc cleanup
  Fri Mar 25 2005
    Ported to linux.
  Wed Jun 11 2003
    Enhanced to also log reflective bands
  Thu May 15 2003
    Enhanced to survive bogus values in source nav data
  Wed Mar 19 2003
    Added sensor azimuth and zenith logging to IBIS file
  Mon Oct 21 2002
    Initial version

.level1
.var inp
MODIS image data set.
.var geo
MODIS geo data set.
.var out
The output file prefix.
.var band
The band to extract.
.var high
Flag selecting high gain version of bands 13 or 14.
.var lineSkip
The number of lines to skip when generating nav/angle data.
.var sampSkip
The number of samples to skip when generating nav/angle data.
.var sl
Starting line of sub-area.
.var ss
Starting sample of sub-area.
.var nl
Number of lines of sub-area.
.var ns
Number of samples of sub-area.
.var minLat
Minimum latitude of sub-area.
.var maxLat
Maximum latitude of sub-area.
.var minLon
Minimum longitude of sub-area.
.var maxLon
Maximum longitude of sub-area.
.level2
.var sl
Starting line of sub-area within MODIS archive data set. This is a
one-based value.
.var ss
Starting sample of sub-area within MODIS archive data set. This is a
one-based value.
.var nl
Number of lines to extract from the MODIS archive data set.
.var ns
Number of samples to extract from MODIS archive data set.
.end

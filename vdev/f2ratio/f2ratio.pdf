process help=*
PARM INP TYPE=STRING COUNT=1:48
PARM OUT TYPE=STRING COUNT=1:48
PARM FCASE TYPE=INT
PARM OPTION TYPE=INT DEFAULT=0
PARM WAY TYPE=INT VALID=1:2 DEFAULT=1
PARM SHADOW TYPE=REAL DEFAULT=80.0
PARM PAN TYPE=INT VALID=0:1 DEFAULT=0
PARM diffac TYPE=REAL DEFAULT=1.0
PARM RATONLY TYPE=INT VALID=0:1 DEFAULT=1
parm dnorm type=int valid=1:3
parm dthresh type=int valid=(5:1000) COUNT=(1:100)
PARM difthr TYPE=INTEGER COUNT=(1:100)
PARM priority TYPE=INTEGER COUNT=(1:100)
parm minsigma type=real default=5.0
parm pixdbg type=int count=2 default=(999999,999999)

END-PROC
.TITLE
f2ratio - image classifier using band ratios and also change detection
.HELP
PURPOSE:
f2ratio combines up to 48 datasets into output datasets, applying hand
programmed functions.  The goal is speeed of operation. The preprogrammed functions as
of Aug 16, 2010, are:

fcase=1:  test case only
fcase=2:  for use by worldview band ratio detection function (ALZ)

EXECUTION:

Example

f2ratio INP=(A,B) OUT=C  FCASE=1    preprogrammed to add two images, just for testing

OPERATION:

the operations are all preprogrammed.  projects can add to the list.

TIMING: 

Faster than using f2.

RESTRICTIONS:

All files must be the same size, and be byte or halfword.  The output will be the same type as the first input. For case 2 the last input is an ibis file.

 ORIGINAL PROGRAMMER:    A. Zobrist          24 May 2011
 COGNIZANT PROGRAMMER:   A. Zobrist          24 May 2011
 
 REVISION HISTORY
  2010-08-10    AZ   Initial version
  
  
.LEVEL1
.VARIABLE INP
STRING - Input image files
.VARIABLE OUT
STRING - Output image file
.VARIABLE FCASE
INT - Which preprogrammed case
.VARIABLE OPTION
INT - SUBCASES:
FCASE=2: OPTION=1 WRITES DIF FILES
.VARIABLE WAY
INT - 1=one way in time 2=two way
.VARIABLE SHADOW
REAL - Threshold for shadow
 in pre band 3
.VARIABLE PAN
INT - 1=two pan inputs for diff
and post multispectral only (see help 2)
.VARIABLE diffac
REAL - default 1.0, use to move all
diff thresholds up or down in 
unison
.VARIABLE RATONLY
INT - 0=normal 1=use ratios only
.var dnorm
1 = use l1 norm
2 = use l2 norm adj for dim.
3 = use linfinity norm
.var dthresh
threshold for ratio detection in units
of sigma (per category)
.var difthr
threshold for difference detection in
units of sigma (per category)
.var priority
a pixel in two or more categories will
be put in category with lowest number
(highest) priority, within a category
closest cluster (by norm) is chosen
.var minsigma
ratio sigmas smaller than this will have
sigma reset to this value
.var pixdbg
enter (line,samp) to debug a pixel
need to read code to interpret
.LEVEL 2
.VARIABLE PAN
For the pan case set pan to 1.
The pan files must be the first two inputs in order pre/post.  Then follow by the post multi-spectral bands.
.END
